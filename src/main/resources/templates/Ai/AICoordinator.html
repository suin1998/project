<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/css/AICoordinator.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
<header>
    <div class="logo">Logo</div>
    <nav>
        <a href="#"></a>
        <a href="#">My Closet</a>
        <a href="#">Main</a>
    </nav>
</header>
<div class="wrapper">

    <aside class="sidebar">
        <h2>AI Coordinator</h2>

        <section class="section">
            <h3>ì§€ì—­ / ë‚ ì§œ</h3>
            <div class="input-group">
                <label>ì§€ì—­</label>
                <button class="dropdown-btn" id="regionBtn">ì§€ì—­ ì„ íƒ</button>
                <div class="excel-file" style="display: none">
                    <input type="file" id="excel-file-input" accept=".xlsx, .xls, .csv">
                </div>
                <div class="dropdown-panel" id="regionDropdown">
                    <select id="sido">
                        <option value="">ì‹œ/ë„ ì„ íƒ</option>
                    </select>

                    <select id="sigungu">
                        <option value="">ì‹œ/êµ°/êµ¬ ì„ íƒ</option>
                    </select>

                    <select id="dong">
                        <option value="">ì/ë©´/ë™ ì„ íƒ</option>
                    </select>
                </div>
            </div>

            <div class="input-group">
                <label>ë‚ ì§œ</label>
                <button class="dropdown-btn" id="dateBtn">ë‚ ì§œ ì„ íƒ</button>
                <div class="dropdown-panel" id="calendarPanel">
                    <input type="date" id="datePicker"/>
                </div>
            </div>
            <div class="check-group" id="checkGroup" style="display: none">
                <button id="checkBtn" class="check-btn">í™•ì¸</button>
            </div>
            <div class="weather-display" id="weatherDisplay">
                <p>ë‚ ì”¨ ì •ë³´ë¥¼ í™•ì¸í•˜ë ¤ë©´ ì§€ì—­ê³¼ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            </div>
        </section>

        <section class="section">
            <h3>ìŠ¤íƒ€ì¼</h3>

            <div class="tag-group">
                <p>íŒ¨ì…˜ ìŠ¤íƒ€ì¼ (ìµœëŒ€ 3ê°œ)</p>
                <div class="tags" id="fashionStyleTags">
                    <span class="tag">ìºì£¼ì–¼</span>
                    <span class="tag">ìŠ¤íŠ¸ë¦¿</span>
                    <span class="tag">í´ë˜ì‹</span>
                    <span class="tag">ë¯¸ë‹ˆë©€</span>
                    <span class="tag">ê³ í”„ì½”ì–´</span>
                    <span class="tag">ìŠ¤í¬í‹°</span>
                    <span class="tag">ê±¸ë¦¬ì‹œ</span>
                    <span class="tag">ì‹œí¬</span>
                    <span class="tag">í”„ë ˆí”¼</span>
                    <span class="tag">ë¡œë§¨í‹±</span>
                    <span class="tag">ë¯¸ë‹ˆë©€</span>
                    <span class="tag">ë ˆíŠ¸ë¡œ</span>
                    <span class="tag">ì—ìŠ¤ë‹‰</span>
                    <span class="tag">ì‹œí‹°ë³´ì´</span>
                    <span class="tag">ë¦¬ì¡°íŠ¸</span>
                    <span class="tag">ì›Œí¬ì›¨ì–´</span>
                    <span class="tag">ë†ˆì½”ë””</span>
                    <span class="tag">í˜ë¯¸ë‹Œ</span>

                </div>
            </div>

            <div class="tag-group">
                <p>ëŠë‚Œ/ì»¨ë””ì…˜ (ìµœëŒ€ 3ê°œ)</p>
                <div class="tags" id="tempStyleTags">
                    <span class="tag">ë”°ëœ»í•œ</span>
                    <span class="tag">ì‹œì›í•œ</span>
                    <span class="tag">ë‹¨ì •í•œ</span>
                    <span class="tag">ê¹”ë”í•œ</span>
                    <span class="tag">ê·€ì—¬ìš´</span>
                    <span class="tag">í™”ì‚¬í•œ</span>
                    <span class="tag">ê²©ì‹ìˆëŠ”</span>
                    <span class="tag">ì„¸ë ¨ëœ</span>
                    <span class="tag">í™”ë ¤í•œ</span>
                    <span class="tag">ë¬´ë‚œí•œ</span>
                    <span class="tag">í¸ì•ˆí•œ</span>
                    <span class="tag">í™œë™ì ì¸</span>
                </div>
            </div>
        </section>

        <section class="section">
            <h3>ìƒí™© (ë‹¨ì¼ ì„ íƒ)</h3>
            <div class="tags" id="situationTags">
                <span class="tag">ì¼ìƒ</span>
                <span class="tag">ìš´ë™</span>
                <span class="tag">ë“±ì‚°</span>
                <span class="tag">ì„œí•‘</span>
                <span class="tag">ëª¨ì„</span>
                <span class="tag">ì†Œê°œíŒ…</span>
                <span class="tag">ë°ì´íŠ¸</span>
                <span class="tag">ê´€ê´‘ì§€</span>
                <span class="tag">íœ´ì–‘ì§€</span>
                <span class="tag">í•™êµ</span>
                <span class="tag">ë©´ì ‘</span>
                <span class="tag">ì§ì¥</span>
                <span class="tag">ìƒê²¬ë¡€</span>
                <span class="tag">ê²°í˜¼ì‹</span>
                <span class="tag">íŒŒí‹°</span>
                <span class="tag">ì‡¼í•‘</span>
                <span class="tag">ì¥ë¡€ì‹</span>

            </div>
        </section>

        <section class="section">
            <h3>ë‚´ ì˜·ì¥</h3>

            <div class="upload-box">
                <label for="clothesInput">+ ì˜· ì‚¬ì§„ ì—…ë¡œë“œ</label>
                <input type="file" id="clothesInput" accept="image/*" multiple/>
            </div>

            <button id="loadSavedBtn" class="load-btn">ì €ì¥ëœ ì˜· ë¶ˆëŸ¬ì˜¤ê¸°</button>

            <div class="category-buttons" id="categoryButtons"></div>

            <div class="my-clothes-list" id="clothesList">
            </div>
        </section>

    </aside>

    <!-- AI ì¶”ì²œ ì˜ì—­ -->
    <main class="main">
        <h2>AI ì½”ë”” ì¶”ì²œ ë¯¸ë¦¬ë³´ê¸°</h2>

        <div class="result-box">
            <!-- AI ì¶”ì²œ ê²°ê³¼ ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ í‘œì‹œ ì˜ˆì • -->
            <p>AIê°€ ì¶”ì²œí•œ ì½”ë””ê°€ ì—¬ê¸° ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
        </div>

        <button class="submit-btn">AI ì½”ë”” ìš”ì²­í•˜ê¸°</button>
    </main>

</div>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script>
    // =========================================================
    // Flatpickr ë¼ì´ë¸ŒëŸ¬ë¦¬ CDN ë¡œë“œ
    // =========================================================

    function loadFlatpickrScripts() {
        // Flatpickr ë©”ì¸ JS
        const fpScript = document.createElement('script');
        fpScript.src = 'https://cdn.jsdelivr.net/npm/flatpickr';
        document.body.appendChild(fpScript);

        // í•œêµ­ì–´ ë¡œì¼€ì¼ JS
        const koScript = document.createElement('script');
        koScript.src = 'https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js';
        document.body.appendChild(koScript);
    }

    document.addEventListener("DOMContentLoaded", () => {

        loadFlatpickrScripts();

        /* ===============================
           1. ë“œë¡­ë‹¤ìš´(ì§€ì—­, ë‚ ì§œ) í† ê¸€
        =============================== */

        // ì§€ì—­ ì„ íƒ ë²„íŠ¼, ì§€ì—­ ë“œë¡­ë‹¤ìš´ ê°€ì ¸ì˜¤ê¸°
        const regionBtn = document.getElementById("regionBtn");
        const regionDropdown = document.getElementById("regionDropdown");

        // ë‚ ì§œ ì„ íƒ ë²„íŠ¼, ë‚ ì§œ ë“œë¡­ë‹¤ìš´ ê°€ì ¸ì˜¤ê¸°
        const dateBtn = document.getElementById("dateBtn");
        const calendarPanel = document.getElementById("calendarPanel");

        // í™•ì¸ ë²„íŠ¼ ê°€ì ¸ì˜¤ê¸°
        const checkGroup = document.getElementById("checkGroup");
        const checkBtn = document.getElementById("checkBtn");

        // ë‚ ì”¨ ì •ë³´ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
        const weatherDisplay = document.getElementById("weatherDisplay");

        // (ì„ íƒí•œ ì§€ì—­ê³¼ ë‚ ì§œì˜ ê°’, í˜„ì¬ëŠ” ê°’ì´ ì—†ìœ¼ë‚˜ ì„ íƒ í›„ ê°’ì´ ìƒê¹€)
        let selectedRegion = null;
        let selectedDate = null;

        let savedRegion = null;
        let savedDate = null;

        // ì§€ì—­ ë“œë¡­ë‹¤ìš´ í† ê¸€
        regionBtn.addEventListener("click", () => {
            regionDropdown.style.display =
                regionDropdown.style.display === "block" ? "none" : "block";
        });

        // ë‚ ì§œ ë“œë¡­ë‹¤ìš´ í† ê¸€ ë° ë‹¬ë ¥ ìƒˆë¡œê³ ì¹¨
        dateBtn.addEventListener("click", () => {
            calendarPanel.style.display =
                calendarPanel.style.display === "block" ? "none" : "block";

            if (window.flatpickrInstance) {
                window.flatpickrInstance.redraw();
            }
        });

        window.flatpickrInstance = null;

        function initializeFlatpickr() {
            const today = new Date();
            const datePickerInput = document.getElementById("datePicker");

            if (typeof flatpickr === 'undefined') {
                setTimeout(initializeFlatpickr, 100);
                return;
            }

            window.flatpickrInstance = flatpickr(datePickerInput, {
                inline: true,

                minDate: "today",
                maxDate: today.fp_incr(10),
                dateFormat: "Yë…„ mì›” dì¼",
                locale: 'ko',

                // ë“œë¡­ë‹¤ìš´ ë‹«ê³  í…ìŠ¤íŠ¸ ìœ„ë¡œ ê°’ì´ ë‚˜ì˜¤ê²Œ í•˜ê¸°
                onChange: function (selectedDates, dateStr, instance) {
                    selectedDate = `${dateStr}`;
                    dateBtn.textContent = selectedDate;
                    calendarPanel.style.display = "none";

                    togglecheckgroupbtn();
                }
            });
        }

        initializeFlatpickr();

        /* ===============================
           2. ì‹œ/ë„ - ì‹œ/êµ°/êµ¬ - ì/ë©´/ë™ (ì—‘ì…€ ê¸°ë°˜)
        =============================== */

        const sidoSelect = document.getElementById("sido");
        const sigunguSelect = document.getElementById("sigungu");
        const dongSelect = document.getElementById("dong");

        let excelData = [];

        fetch("/sub_file/Korea_area.xlsx")  // ì—¬ê¸°ì— ì‹¤ì œ ê²½ë¡œ ë„£ê¸°
            .then(response => response.arrayBuffer())
            .then(buffer => {
                const workbook = XLSX.read(buffer, {type: "array"});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                excelData = XLSX.utils.sheet_to_json(sheet);

                excelData = excelData.filter(row =>
                    row["ì‹œë„"] &&
                    row["ì‹œêµ°êµ¬"] &&
                    row["ìë©´ë™"]
                );

                populateSido();
            })
            .catch(err => console.error("ì—‘ì…€ ë¡œë“œ ì‹¤íŒ¨:", err));

        //  ì‹œ/ë„ ì±„ìš°ê¸°
        function populateSido() {
            const sidoList = [...new Set(excelData.map(row => row["ì‹œë„"]))];
            sidoSelect.innerHTML = `<option value="">ì‹œ/ë„ ì„ íƒ</option>`; // ê¸°ë³¸ ì˜µì…˜ ì´ˆê¸°í™”

            sidoList.forEach(sido => {
                const option = document.createElement("option");
                option.value = sido;
                option.textContent = sido;
                sidoSelect.appendChild(option);
            });
        }

        //  ì‹œêµ°êµ¬ ì±„ìš°ê¸°
        sidoSelect.addEventListener("change", () => {
            sigunguSelect.innerHTML = `<option value="">ì‹œ/êµ°/êµ¬ ì„ íƒ</option>`;
            dongSelect.innerHTML = `<option value="">ì/ë©´/ë™ ì„ íƒ</option>`;

            if (!sidoSelect.value) return;

            const filtered = excelData.filter(row => row["ì‹œë„"] === sidoSelect.value);
            const sigunguList = [...new Set(filtered.map(row => row["ì‹œêµ°êµ¬"]))];

            sigunguList.forEach(sg => {
                const option = document.createElement("option");
                option.value = sg;
                option.textContent = sg;
                sigunguSelect.appendChild(option);
            });
        });

        //  ìë©´ë™ ì±„ìš°ê¸°
        sigunguSelect.addEventListener("change", () => {
            dongSelect.innerHTML = `<option value="">ì/ë©´/ë™ ì„ íƒ</option>`;

            if (!sigunguSelect.value) return;

            const filtered = excelData.filter(
                row => row["ì‹œë„"] === sidoSelect.value && row["ì‹œêµ°êµ¬"] === sigunguSelect.value
            );

            const dongList = [...new Set(filtered.map(row => row["ìë©´ë™"]))];

            dongList.forEach(d => {
                const option = document.createElement("option");
                option.value = d;
                option.textContent = d;
                dongSelect.appendChild(option);
            });

        });

        // ë“œë¡­ë‹¤ìš´ ë‹«ê³  í…ìŠ¤íŠ¸ ìœ„ë¡œ ê°’ì´ ë‚˜ì˜¤ê²Œ í•˜ê¸°(ì§€ì—­ ê°’)
        dongSelect.addEventListener("change", () => {
            selectedRegion = `${sidoSelect.value} ${sigunguSelect.value} ${dongSelect.value}`;
            regionBtn.textContent = selectedRegion;

            regionDropdown.style.display = "none";
            togglecheckgroupbtn();
        });

        // ì§€ì—­ ê°’ê³¼ ë‚ ì§œ ê°’ ì„ íƒ ì‹œ í™•ì¸ ë²„íŠ¼ í‘œì‹œ
        function togglecheckgroupbtn() {
            if(selectedDate && selectedDate) {
                checkGroup.style.display = "block";
            } else {
                checkGroup.style.display = "none";
            }
        }

        // ì§€ì—­ ê°’ê³¼ ë‚ ì”¨ ê°’ ì €ì¥ ë° ì¶œë ¥
        checkBtn.addEventListener("click", () => {
            savedRegion = selectedRegion;
            savedDate = selectedDate;

            const weatherDisplayhtml =
                `${savedRegion}ì—
                ${savedDate} ë‚ ì”¨ëŠ”
                (ë‚˜ì¤‘ì— ë‚ ì”¨ì™€ ì˜¨ë„, ê°•ìˆ˜ëŸ‰ìœ¼ë¡œ ë‚˜ì˜µë‹ˆë‹¤.) ì…ë‹ˆë‹¤.`;

            weatherDisplay.textContent = weatherDisplayhtml;

            checkGroup.style.display = "none";

        })

        /* ===============================
           íƒœê·¸ í´ë¦­ (ìµœëŒ€ 3ê°œ)
        =============================== */
        function setupTagLimit(containerId, maxCount) {
            const container = document.getElementById(containerId);
            const tags = container.querySelectorAll(".tag");

            tags.forEach(tag => {
                tag.addEventListener("click", () => {
                    if (tag.classList.contains("active")) {
                        tag.classList.remove("active");
                    } else {
                        const selected = container.querySelectorAll(".active");
                        if (selected.length >= maxCount) return;
                        tag.classList.add("active");
                    }
                });
            });
        }

        setupTagLimit("fashionStyleTags", 3);
        setupTagLimit("tempStyleTags", 3);


        /* ===============================
           ìƒí™© íƒœê·¸ (1ê°œë§Œ ì„ íƒ)
        =============================== */
        const situationTags = document.querySelectorAll("#situationTags .tag");

        situationTags.forEach(tag => {
            tag.addEventListener("click", () => {
                if (tag.classList.contains("active")) {
                    tag.classList.remove("active");
                    return;
                }
                situationTags.forEach(t => t.classList.remove("active"));
                tag.classList.add("active");
            });
        });


        /* ===============================
           ì‚¬ì§„ ì—…ë¡œë“œ â†’ ì¸ë„¤ì¼ í‘œì‹œ
        =============================== */
        const input = document.getElementById("clothesInput");
        const clothesList = document.getElementById("clothesList");

        input.addEventListener("change", () => {
            const files = Array.from(input.files);

            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = document.createElement("img");
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        });

        /* =====================================
            ì˜· ì¹´í…Œê³ ë¦¬ ê¸°ëŠ¥ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        ===================================== */

        let clothesData = [];
        const categories = ["í‹°ì…”ì¸ ", "íŒ¬ì¸ ", "ì•„ìš°í„°", "ì›í”¼ìŠ¤", "ê¸°íƒ€"];

        const categoryButtons = document.getElementById("categoryButtons");


        /* =====================================
            ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ìƒì„±
        ===================================== */
        function renderCategoryButtons() {
            categoryButtons.innerHTML = "";
            categories.forEach(cat => {
                const btn = document.createElement("button");
                btn.textContent = cat;
                btn.addEventListener("click", () => {
                    document.querySelectorAll("#categoryButtons button")
                        .forEach(b => b.classList.remove("active"));
                    btn.classList.add("active");

                    renderClothes(cat);
                });
                categoryButtons.appendChild(btn);
            });
        }

        renderCategoryButtons();


        /* =====================================
            AI ìë™ë¶„ë¥˜ (ê°„ë‹¨í•œ íŒŒì¼ëª… ê¸°ë°˜)
        ===================================== */
        function autoCategory(fileName) {
            const lower = fileName.toLowerCase();

            if (lower.includes("shirt") || lower.includes("tee")) return "í‹°ì…”ì¸ ";
            if (lower.includes("pants") || lower.includes("jean")) return "íŒ¬ì¸ ";
            if (lower.includes("jacket") || lower.includes("coat")) return "ì•„ìš°í„°";
            if (lower.includes("onepiece") || lower.includes("dress")) return "ì›í”¼ìŠ¤";
            return "ê¸°íƒ€";
        }


        /* =====================================
            ì˜· ì—…ë¡œë“œ ì‹œ ìë™ ë¶„ë¥˜ ë° ë°ì´í„° ì €ì¥
        ===================================== */

        input.addEventListener("change", () => {
            const files = Array.from(input.files);

            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = e => {
                    const category = autoCategory(file.name);

                    clothesData.push({
                        src: e.target.result,
                        category: category
                    });

                    // ë°ì´í„°ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§
                    renderClothes();
                };
                reader.readAsDataURL(file);
            });
        });


        /* =====================================
            ì €ì¥ëœ ìƒ˜í”Œ ë¶ˆëŸ¬ì˜¤ê¸° (ìƒ˜í”Œ íŒŒì¼ì´ê¸° ë•Œë¬¸ì— ì•ˆì— sampleImagesëŠ” ì§€ì›Œë„ ë©ë‹ˆë‹¤.)
        ===================================== */
        const loadSavedBtn = document.getElementById("loadSavedBtn");

        loadSavedBtn.addEventListener("click", () => {
            const sampleImages = [
                {src: "/static/sample/tshirt1.jpg", category: "í‹°ì…”ì¸ "},
                {src: "/static/sample/pants1.jpg", category: "íŒ¬ì¸ "},
                {src: "/static/sample/jacket1.jpg", category: "ì•„ìš°í„°"}
            ];

            clothesData = clothesData.concat(sampleImages);
            renderClothes();
        });


        /* =====================================
            ì˜· ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        ===================================== */
        function renderClothes(filterCategory = null) {
            clothesList.innerHTML = "";

            const list = filterCategory
                ? clothesData.filter(c => c.category === filterCategory)
                : clothesData;

            list.forEach(c => {
                const img = document.createElement("img");
                img.src = c.src;
                clothesList.appendChild(img);
            });
        }








    });

    const API_URL = 'http://localhost:8080/AI';

    const $siDo = document.getElementById('sido');
    const $siGunGu = document.getElementById('sigungu');
    const $dong = document.getElementById('dong');
    const $datePicker = document.getElementById('datePicker');
    const $weatherDisplay = document.getElementById('weatherDisplay');

    const $checkWeatherBtn = document.getElementById('checkBtn');
    // ì„ íƒëœ ì§€ì—­ ë° ë‚ ì§œ ì €ì¥ ë³€ìˆ˜
    let selectedRegion = {
        siDo: '',
        siGunGu: '',
        dong: ''
    };
    let selectedDate = '';

    document.addEventListener('DOMContentLoaded', () => {
        // ... (ê¸°ì¡´ ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ: setupDropdownToggles(), setupFlatpickr(), setupRegionEventListeners() ë“±) ...

        // ğŸ’¡ ë‚ ì”¨ ì¡°íšŒ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        $checkWeatherBtn.addEventListener('click', fetchWeather);

        // ì´ˆê¸° ë‚ ì§œ ë° ì§€ì—­ ê°’ ì„¤ì • (HTMLì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ë„ë¡)
        selectedDate = $datePicker.value;
        selectedRegion.siDo = $siDo.value;
        selectedRegion.siGunGu = $siGunGu.value;
        selectedRegion.dong = $dong.value;
    });


    function isWeatherQueryReady() {
        return selectedRegion.siDo && selectedRegion.siGunGu && selectedRegion.dong && selectedDate;
    }

    async function fetchWeather() {
        if (!isWeatherQueryReady()) return;

        // 1. ìš”ì²­ URL êµ¬ì„±
        const params = new URLSearchParams({
            siDo: selectedRegion.siDo,
            siGunGu: selectedRegion.siGunGu,
            dong: selectedRegion.dong,
            inputDate: selectedDate
        });

        const fullUrl = `${API_URL}?${params.toString()}`;
        $weatherDisplay.innerHTML = '<p>ë‚ ì”¨ ì •ë³´ ì¡°íšŒ ì¤‘...</p>';

        try {
            const response = await fetch(fullUrl);
            const data = await response.json();

            if (response.ok) {
                // 200 OK
                displayWeatherResult(data);
            } else {
                // 4xx, 5xx ì—ëŸ¬ ì²˜ë¦¬
                $weatherDisplay.innerHTML = `<p class="error">ì¡°íšŒ ì‹¤íŒ¨: ${data.message || 'API í˜¸ì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'}</p>`;
                console.error('API Error Response:', data);
            }
        } catch (error) {
            $weatherDisplay.innerHTML = `<p class="error">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë˜ëŠ” JSON íŒŒì‹± ì˜¤ë¥˜</p>`;
            console.error('Fetch Error:', error);
        }
    }
    function displayWeatherResult(data) {
        let html = `<p><strong>ğŸ“ ${data.targetDate} (${selectedRegion.siDo} ${selectedRegion.siGunGu} ${selectedRegion.dong})</strong></p>`;

        if (data.shortTerm) {
            const s = data.shortTerm;
            html += `
            <div class="weather-forecast short-term">
                <p>ìµœì € ê¸°ì˜¨: ${s.tMin}Â°C</p>
                <p>ìµœê³  ê¸°ì˜¨: ${s.tMax}Â°C</p>
                <p>ê°•ìˆ˜ í™•ë¥  (POP): ${s.rainProb}%</p>
            </div>
        `;
        } else if (data.midTerm) {
            const m = data.midTerm;
            html += `
            <div class="weather-forecast mid-term">
                <p>ìµœì € ê¸°ì˜¨: ${m.tMin}Â°C</p>
                <p>ìµœê³  ê¸°ì˜¨: ${m.tMax}Â°C</p>
                <p>ê°•ìˆ˜ í™•ë¥ : ${m.rainProb}%</p>
                </div>
        `;
        } else {
            html += '<p>í•´ë‹¹ ë‚ ì§œì— ìœ íš¨í•œ ë‚ ì”¨ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        }

        $weatherDisplay.innerHTML = html;
    }

</script>
</body>
</html>