<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../../static/css/postUp.css">
</head>
<body>
<header>
    <div class="logo">Logo</div>
    <nav>
        <a href="#">Logout</a>
        <a href="#">Main</a>
    </nav>
</header>
<div class="container">
    <form class="postForm">
        <label for="title-input">제목</label>
        <input type="text" id="title-input" class="title" required>

        <label>추천 코디</label>
        <div class="image-btn-box">
            <button type="button" class="open-modal-btn">이미지 추가</button>
        </div>

        <!-- 이미지 미리보기 표시 영역 -->
        <div class="image-list" id="imageList"></div>

        <!-- 이미지 선택 모달 -->
        <div class="image-modal" id="imageModal">
            <div class="modal-content">
                <h3>이미지 선택</h3>

                <div class="image-category-box">
                    <button type="button" data-category="all" class="category-btn active">전체</button>
                    <button type="button" data-category="top" class="category-btn">상의</button>
                    <button type="button" data-category="bottom" class="category-btn">하의</button>
                    <button type="button" data-category="acc" class="category-btn">악세서리</button>
                </div>
                <div class="sample-image-list" id="sampleImageList">
                    <!-- JS에서 샘플 이미지 자동 로드 -->
                </div>

                <button class="modal-close-btn">닫기</button>
            </div>
        </div>

        <label for="text-input">내용</label>
        <textarea id="text-input" class="textPost" required></textarea>
        <div class="btn-group">
            <button type="submit" class="submit-btn">작성</button>
            <button type="button" class="delete-btn">삭제</button>
        </div>
    </form>
</div>

<script>
    const openModalBtn = document.querySelector(".open-modal-btn");
    const imageModal = document.getElementById("imageModal");
    const closeModalBtn = document.querySelector(".modal-close-btn");
    const sampleImageList = document.getElementById("sampleImageList");
    const imageList = document.getElementById("imageList");

    /* 샘플 이미지 URL */
    const sampleImageURLs = [
        "https://picsum.photos/200?random=1",
        "https://picsum.photos/200?random=2",
        "https://picsum.photos/200?random=3",
        "https://picsum.photos/200?random=4",
        "https://picsum.photos/200?random=5",
        "https://picsum.photos/200?random=7",
        "https://picsum.photos/200?random=8",
        "https://picsum.photos/200?random=9",
        "https://picsum.photos/200?random=10",
        "https://picsum.photos/200?random=11",
        "https://picsum.photos/200?random=12"

    ];

    /* --- 자동 카테고리 분류 로직 --- */
    function classifyCategory(url) {
        const num = parseInt(url.match(/random=(\d+)/)[1]);

        if (num === 1 || num === 2 || num === 6) return "top";
        if (num === 3 || num === 4) return "bottom";
        if (num === 5) return "acc";
        return "top";
    }

    /* 자동 분류된 샘플 이미지 배열 생성 */
    const sampleImages = sampleImageURLs.map(url => ({
        url,
        category: classifyCategory(url)
    }));

    /* 모달 열기 */
    openModalBtn.addEventListener("click", () => {
        imageModal.style.display = "flex";
    });

    /* 모달 닫기 */
    closeModalBtn.addEventListener("click", () => {
        imageModal.style.display = "none";
    });

    /* 샘플 이미지 렌더 함수 */
    function renderSampleImages(filter = "all") {
        sampleImageList.innerHTML = "";
        sampleImages
            .filter(img => filter === "all" || img.category === filter)
            .forEach(img => {
                const div = document.createElement("div");
                div.classList.add("sample-image");
                div.innerHTML = `<img src="${img.url}" width="100%" height="100%" alt="" />`;

                div.addEventListener("click", () => {
                    addPreviewImage(img.url);
                    imageModal.style.display = "none";
                });

                sampleImageList.appendChild(div);
            });
    }

    renderSampleImages();

    /* 카테고리 버튼 이벤트 */
    document.querySelectorAll(".category-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            document.querySelectorAll(".category-btn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");

            const category = btn.dataset.category;
            renderSampleImages(category);
        });
    });

    /* 미리보기 추가 */
    function addPreviewImage(imgURL) {
        const preview = document.createElement("div");
        preview.classList.add("image-preview");

        preview.innerHTML = `
        <img src="${imgURL}" alt="">
        <button class="delete-image-btn">X</button>
    `;

        imageList.appendChild(preview);

        // 삭제 기능
        preview.querySelector(".delete-image-btn").addEventListener("click", () => {
            preview.remove();
        });
    }

</script>
</body>
</html>