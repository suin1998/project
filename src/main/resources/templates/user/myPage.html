<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Closet</title>
    <link rel="stylesheet" href="/css/myPage.css">
</head>
<body>
<header>
    <div class="logo"></div>
    <nav>
        <a href="#" id="logout"></a>
        <a href="#" id="main"></a>
        <a href="#" id="AICoordinator"></a>
    </nav>
</header>
<div class="container">
    <div class="container-dashboard">
        <section class="dashboard">
            <div class="calendar-card">
                <div class="calendar-herder">
                    <button id="prev"><</button>
                    <h3 id="monthYear"></h3>
                    <button id="next">></button>
                </div>
                <table id="calendar">
                    <thead>
                    <tr>
                        <th>Sun</th>
                        <th>Mon</th>
                        <th>Tue</th>
                        <th>Wed</th>
                        <th>Thu</th>
                        <th>Fri</th>
                        <th>Sat</th>
                    </tr>
                    </thead>
                    <tbody id="calendarBody"></tbody>
                </table>
            </div>
        </section>

        <section class="profile">
            <div class="profile-card">
                <div class="profile-img">
                    <!--                샘플 이미지-->
                    <img src="/image/user/user-img.jpg" alt="">
                </div>
                <div class="profile-text">
                    <h3 id="user-name">000님 안녕하세요</h3>
                    <a href="#" id="profile-edit">정보수정</a>
                </div>
            </div>
        </section>
    </div>
    <div class="container-editors">
        <div class="tag-list">
            <!--            샘플버튼 디자인만 보세요-->
            <input type="radio" id="btn-top" name="category" value="top" checked>
            <label for="btn-top" class="btn">티셔츠</label>
            <input type="radio" id="btn-bottom" name="category" value="bottom">
            <label for="btn-bottom" class="btn">팬츠</label>
            <input type="radio" id="btn-outer" name="category" value="outer">
            <label for="btn-outer" class="btn">아우터</label>
            <input type="radio" id="btn-shoes" name="category" value="shoes">
            <label for="btn-shoes" class="btn">신발</label>
            <input type="radio" id="btn-bag" name="category" value="bag">
            <label for="btn-bag" class="btn">가방</label>
            <input type="radio" id="btn-hat" name="category" value="hat">
            <label for="btn-hat" class="btn">모자</label>
            <input type="radio" id="btn-accessory" name="category" value="accessory">
            <label for="btn-accessory" class="btn">악세서리</label>
        </div>
        <div class="image-area">
            <!--            샘플 이미지 디자인만 보세요.-->
            <div id="imageCount">티셔츠 3개</div>
            <div id="closetContainer" class="image-grid">
                <img src="../../static/image/user/tShirt1.jpg" alt="">
                <img src="../../static/image/user/tShirt2.jpg" alt="">
                <img src="../../static/image/user/tShirt3.jpg" alt="">
            </div>
        </div>
    </div>
</div>

<script>
    /** ---------- 사용자 정보 셋업 ---------- **/
    const userId = "user123"; // 로그인 시 서버에서 전달받도록 변경 예정

    /** ---------- 달력 렌더링 ---------- **/
    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();

    const monthYear = document.getElementById("monthYear");
    const calendarBody = document.getElementById("calendarBody");

    function renderCalendar() {
        calendarBody.innerHTML = "";

        const firstDay = new Date(currentYear, currentMonth, 1).getDay();
        const lastDate = new Date(currentYear, currentMonth + 1, 0).getDate();

        monthYear.textContent = `${currentYear}년 ${currentMonth + 1}월`;

        let row = document.createElement("tr");

        for (let i = 0; i < firstDay; i++) {
            row.appendChild(document.createElement("td"));
        }

        for (let day = 1; day <= lastDate; day++) {
            if (row.children.length === 7) {
                calendarBody.appendChild(row);
                row = document.createElement("tr");
            }
            const cell = document.createElement("td");
            cell.textContent = day;

            // 오늘 날짜 강조
            if (
                currentYear === today.getFullYear() &&
                currentMonth === today.getMonth() &&
                day === today.getDate()
            ) {
                cell.classList.add("today");
            }

            row.appendChild(cell);
        }
        calendarBody.appendChild(row);
    }

    document.getElementById("prev").addEventListener("click", () => {
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
        }
        renderCalendar();
    });

    document.getElementById("next").addEventListener("click", () => {
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
        }
        renderCalendar();
    });


    // /** ---------- 옷 불러오기 API 연동 ---------- **/
    // const closetContainer = document.getElementById("closetContainer");
    // const imageCount = document.getElementById("imageCount");
    //
    // async function loadCloset(category) {
    //     try {
    //         const res = await fetch(`/api/closet/${userId}/${category}`);
    //         if (!res.ok) throw new Error("Failed to load closet");
    //
    //         const items = await res.json();
    //         renderCloset(items, category);
    //     } catch (e) {
    //         console.error(e);
    //         closetContainer.innerHTML = `<p>불러오기에 실패했습니다.</p>`;
    //     }
    // }

    // function renderCloset(items, category) {
    //     closetContainer.innerHTML = "";
    //
    //     items.forEach(item => {
    //         const img = document.createElement("img");
    //         img.src = item.imageUrl;
    //         img.alt = `${category}`;
    //         img.loading = "lazy"; // ✅ lazy-loading 적용
    //         img.classList.add("closet-image");
    //         closetContainer.appendChild(img);
    //     });
    //
    //     imageCount.textContent = `${category} ${items.length}개`;
    // }

    /** ---------- 카테고리 선택 이벤트 ---------- **/
    document.querySelectorAll("input[name='category']").forEach(radio => {
        radio.addEventListener("change", (e) => {
            loadCloset(e.target.value);
        });
    });

    /** ---------- 초기 실행 ---------- **/
    loadCloset("top");

</script>
</body>
</html>